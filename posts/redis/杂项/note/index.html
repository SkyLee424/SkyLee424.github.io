<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head>
  <title>Redis 杂项 - Sky_Lee 的个人博客</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Redis 事务 基本使用 redis 的事务与传统关系性数据库的事务不同，没有 ACID 特性 开启事务可以使用 MULTI 命令 回滚事务可以使用 DISCARD 命令 提交事务可以使用 EXEC 命令 为了防止多客"
/>
<meta
  name="keywords"
  content="Sky_Lee, 博客, blogs"
/>
<meta name="robots" content="noodp" />
<meta property="og:title" content="Redis 杂项" />
<meta property="og:description" content="Redis 事务 基本使用 redis 的事务与传统关系性数据库的事务不同，没有 ACID 特性 开启事务可以使用 MULTI 命令 回滚事务可以使用 DISCARD 命令 提交事务可以使用 EXEC 命令 为了防止多客" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blogs.skylee.top/posts/redis/%E6%9D%82%E9%A1%B9/note/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-03-10T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Redis 杂项"/>
<meta name="twitter:description" content="Redis 事务 基本使用 redis 的事务与传统关系性数据库的事务不同，没有 ACID 特性 开启事务可以使用 MULTI 命令 回滚事务可以使用 DISCARD 命令 提交事务可以使用 EXEC 命令 为了防止多客"/>


<link rel="canonical" href="https://blogs.skylee.top/posts/redis/%E6%9D%82%E9%A1%B9/note/" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" href="/css/index.min.34171dbe77d81f5e42f37a2347d103495b3a01fff5f218c44b0122b7fea127d6.css">









  
</head>
<body class="flex flex-col min-h-screen w-full bg-slate-50 dark:bg-gray-800">
  <header class="flex flex-none justify-center z-10">
    <div class="flex flex-row gap justify-between w-full max-w-4xl lg:max-w-5xl h-12 mt-3">
  <div class="flex-none ml-2 md:ml-0">
    <a href="/" class="">
      <img class="h-12 w-12 rounded-full object-cover bg-gray-100" src="http://images.bluebell.skylee.top/bluebell%2Favatar%2F0ae39267eb81693c01509301b7278638d9e540dc18e99e64c071ad0f1c705f60" alt="logo">
    </a>
  </div>
  <div class="flex-1"></div>
  <div class="flex-none">
    



<nav class="h-full static">
  <button id="navbar-menu-toggle" type="button" class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg md:hidden" aria-controls="navbar-menu" aria-expanded="false">
    <span class="sr-only">Open main menu</span>
    <i class="w-8 h-8">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 6l16 0" />
  <path d="M4 12l16 0" />
  <path d="M4 18l16 0" />
</svg>

    </i>
  </button>
  <div class="absolute md:static top-16 left-0 right-0 z-50 hidden w-full md:block md:w-auto" id="navbar-menu">
    <ul class="flex flex-col mx-2 md:mx-0 md:flex-row md:border-0 rounded-sm md:rounded-full px-3 text-base font-medium text-slate-800 dark:text-slate-200 shadow-lg bg-white dark:bg-gray-600 shadow-slate-800/5 dark:shadow-slate-200/5 ring-1 ring-slate-900/5 dark:ring-slate-100/5">
    
        <li id="about" class="">
          <a class="block px-3 py-3 hover:text-emerald-600"
            href="/about/" title="About">About</a>
        </li>
      
    
        <li id="post" class="">
          <a class="block px-3 py-3 hover:text-emerald-600 text-emerald-600"
            href="/posts/" title="Post">Post</a>
        </li>
      
    
    </ul>
  </div>
</nav>


  </div>
  
  <div class="flex-none mx-1"></div>
  
  <div class="flex-none md:hidden">
    <a href=/search/ class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg" aria-controls="navbar-menu" aria-expanded="false">
      <span class="sr-only">Search</span>
      <i class="w-8 h-8">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
    <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
    <path d="M21 21l-6 -6" />
</svg>

      </i>
    </a>
  </div>
  <div class="darkmode-toggle flex flex-none mr-2 md:mr-0">
    <label for="darkmode-toggle" class="flex items-center px-3 cursor-pointer rounded-full bg-gray-100 dark:bg-gray-600" title="Toggle dark mode">
      <input name="darkmode-toggle" id="darkmode-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle dark mode">
      <div class="group flex flex-row gap-1 justify-center h-8 px-1 rounded-full bg-white dark:bg-gray-700">
        <i class="h-6 w-6 flex-none rounded-full bg-yellow-400 place-self-center peer-checked:group-[]:invisible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brightness-down" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
   <path d="M12 5l0 .01"></path>
   <path d="M17 7l0 .01"></path>
   <path d="M19 12l0 .01"></path>
   <path d="M17 17l0 .01"></path>
   <path d="M12 19l0 .01"></path>
   <path d="M7 17l0 .01"></path>
   <path d="M5 12l0 .01"></path>
   <path d="M7 7l0 .01"></path>
</svg>

        </i>
        <i class="h-6 w-6 flex-none rounded-full place-self-center invisible peer-checked:group-[]:visible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon-stars" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
   <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
   <path d="M19 11h2m-1 -1v2"></path>
</svg>

        </i>
      </div>
    </label>
  </div>
</div>

  </header>
  <main class="flex flex-auto justify-center">
    
<div class="w-full max-w-4xl lg:max-w-5xl">
  <div class="flex flex-col gap-y-3 p-6 mt-6 mx-2 md:mx-0 rounded-lg shadow-md bg-white dark:bg-gray-700">
    <h1 class="text-4xl font-semibold text-slate-800 dark:text-slate-100">
      <a href="/posts/redis/%E6%9D%82%E9%A1%B9/note/">Redis 杂项</a>
    </h1>

    
    
  <ul class="flex flex-row flex-wrap text-slate-500 dark:text-slate-300">
    
      
      <li>
        <a href="/categories/redis/"
          class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">
          Redis
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/tags/redis/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Redis</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/cache/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Cache</span>
        </a>
      </li>
      
    
  </ul>



    <div class="flex flex-col gap-y-1 md:flex-row md:gap-y-0 md:gap-x-4 text-slate-500 dark:text-slate-300">
  
  
  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z"></path>
   <path d="M16 3v4"></path>
   <path d="M8 3v4"></path>
   <path d="M4 11h16"></path>
   <path d="M11 15h1"></path>
   <path d="M12 15v3"></path>
</svg>

    </i>
    <time datetime="2024-03-10T00:00:00&#43;00:00">
      2024-03-10
    </time>
  </div>

  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hourglass-high" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M6.5 7h11"></path>
   <path d="M6 20v-2a6 6 0 1 1 12 0v2a1 1 0 0 1 -1 1h-10a1 1 0 0 1 -1 -1z"></path>
   <path d="M6 4v2a6 6 0 1 0 12 0v-2a1 1 0 0 0 -1 -1h-10a1 1 0 0 0 -1 1z"></path>
</svg>

    </i>
    <span>
      9 minutes to read
    </span>
  </div>
</div>


    
      
      <section class="prose prose-slate dark:prose-invert w-full max-w-4xl lg:max-w-5xl mt-6">
        <h2>Table of Contents</h2>
        <aside><nav id="TableOfContents">
  <ul>
    <li><a href="#redis-事务">Redis 事务</a>
      <ul>
        <li><a href="#基本使用">基本使用</a></li>
        <li><a href="#局限性">局限性</a></li>
        <li><a href="#redis-事务支持回滚吗">Redis 事务支持回滚吗？</a></li>
        <li><a href="#redis-事务具有原子性嘛">Redis 事务具有原子性嘛？</a></li>
      </ul>
    </li>
    <li><a href="#redis-性能优化">Redis 性能优化</a>
      <ul>
        <li><a href="#批量发送数据">批量发送数据</a></li>
        <li><a href="#bigkey-优化">bigkey 优化</a></li>
        <li><a href="#hotkey-优化">hotkey 优化</a></li>
        <li><a href="#内存碎片问题">内存碎片问题</a></li>
      </ul>
    </li>
    <li><a href="#redis-生产问题">Redis 生产问题</a>
      <ul>
        <li><a href="#缓存雪崩击穿穿透与缓存一致性">缓存雪崩、击穿、穿透与缓存一致性</a></li>
        <li><a href="#常见阻塞情况">常见阻塞情况</a></li>
      </ul>
    </li>
  </ul>
</nav></aside>
      </section>
      
    

    <article class="mt-6 w-full max-w-4xl lg:max-w-5xl prose prose-slate dark:prose-invert prose-quoteless post-content">
      <h2 id="redis-事务">Redis 事务</h2>
<h3 id="基本使用">基本使用</h3>
<p>redis 的事务与传统关系性数据库的事务不同，没有 ACID 特性</p>
<ul>
<li>开启事务可以使用 <code>MULTI</code> 命令</li>
<li>回滚事务可以使用 <code>DISCARD</code> 命令</li>
<li>提交事务可以使用 <code>EXEC</code> 命令</li>
</ul>
<p>为了防止多客户端的并发修改，可以在开启事务前使用 WATCH 命令监视要修改的键</p>
<blockquote>
<p>WATCH 命令用于监视一个或多个键，如果被监视的键在事务执行前被其他客户端修改，当前事务将被中止。</p>
</blockquote>
<h3 id="局限性">局限性</h3>
<ul>
<li>不支持回滚</li>
<li>客户端与 Server 交互，是一条一条，而不是一批一批</li>
</ul>
<h3 id="redis-事务支持回滚吗">Redis 事务支持回滚吗？</h3>
<ol>
<li>若在事务队列中存在命令格式错误（类似于 java 编译性错误），则执行 EXEC 命令时，<strong>所有命令都不会执行</strong></li>
<li>若在事务队列中存在其它错误（如网络错误、Redis 服务器本身出现问题），则执行 EXEC 命令时，<strong>所有命令都会执行</strong>，只不过部分成功，部分失败</li>
</ol>
<p>因此，Redis 事务 <strong>不支持回滚</strong>，第一种情况只是看起来像回滚，但这实际上是代码编写的问题，当然可以“回滚”，不在本次问题的讨论范围</p>
<blockquote>
<p>为什么不支持回滚？</p>
</blockquote>
<p><a href="https://redis.io/docs/interact/transactions/#what-about-rollbacks" target="_blank" rel="noopener">Redis 官方</a>
 是这样说的：</p>
<blockquote>
<p>Redis does not support rollbacks of transactions since supporting rollbacks would have a significant impact on the simplicity and performance of Redis.</p>
<p>Redis commands can fail only if called with a wrong syntax</p>
</blockquote>
<p>简单来说，就是 Redis 认为没有必要实现回滚，破坏了 Redis 的简单性，对性能也有显著影响</p>
<p>此外，Redis 认为：Redis 的命令只会在出现语法错误的情况下，执行失败，这种错误是可以在开发的时候发现的，也没有必要实现回滚</p>
<p>当然，错误的发生还有一种情况：事务执行过程中，Redis Server 宕机了，这种情况下，会出现事务执行了一半的情况吗？可以看看这个 <a href="https://github.com/Snailclimb/JavaGuide/issues/491" target="_blank" rel="noopener">讨论</a>
</p>
<blockquote>
<p>Redis 本身就是用作缓存的，搞这么复杂干嘛</p>
<p>如果你把 Redis 用作缓存，那么更新数据时，完全可以把缓存删掉（如果删除失败，可以引入补偿机制），不需要回滚的支持</p>
</blockquote>
<h3 id="redis-事务具有原子性嘛">Redis 事务具有原子性嘛？</h3>
<blockquote>
<p>Either all of the commands or none are processed, so a Redis transaction is also atomic.</p>
</blockquote>
<p>Redis 官方认为：原子性指的是：<strong>一组命令，要么全部执行，要么全部不执行</strong></p>
<p>那么从这个角度来看，Redis 事务是 <strong>具有原子性的</strong>，在命令本身没有语法错误的情况下：</p>
<ul>
<li>执行 EXEC，命令 <strong>全部执行</strong></li>
<li>执行 DISCARD，命令 <strong>全部不执行</strong></li>
</ul>
<p>但维基百科认为 <a href="https://zh.wikipedia.org/wiki/ACID" target="_blank" rel="noopener">原子性</a>
 的定义是：一个事务（transaction）中的所有操作，<strong>或者全部完成，或者全部不完成</strong>，不会结束在中间某个环节。事务在执行过程中发生错误，<strong>会被回滚（Rollback）到事务开始前的状态</strong>，就像这个事务从来没有执行过一样。即，事务不可分割、不可约简。</p>
<p>由于 Redis 不支持回滚，也就不满足通常意义上的「原子性」了</p>
<p>总结一下：</p>
<p>Redis 的事务是 <strong>原子操作</strong>，即在事务执行过程中，不会被其它事务干扰，但不具备传统意义上的原子性，因为不支持回滚</p>
<h2 id="redis-性能优化">Redis 性能优化</h2>
<h3 id="批量发送数据">批量发送数据</h3>
<p>传统的 C/S 交互方式，通常是：</p>
<ul>
<li>Client 发一条消息，等待</li>
<li>Server 接收到一条消息，处理</li>
<li>Server 将结果返回给客户端</li>
</ul>
<p>在这种交互方式下，一条命令，在 Server 端就需要一次 read syscall 和一次 write syscall</p>
<p>一条命令的情况还好，但是如果是很多命令，频繁的 syscall，会带来很大的开销</p>
<p>可以想到的一种优化方式是 <strong>一次性发送一批数据</strong></p>
<p>在 Redis 中，经常使用 pipeline 来批量发送命令。在这种机制下，客户端发送完一条命令后，不是等待，而是接着发送第二条</p>
<p>这样，在 Server 端，调用一次 read，就可以读取很多命令，调用一次 write，就可以发送很多响应，节省了很多系统调用的开销</p>
<blockquote>
<p>Pipelining is not just a way to reduce the latency cost associated with the round trip time, it actually greatly improves the number of operations you can perform per second in a given Redis server. This is because without using pipelining, serving each command is very cheap from the point of view of accessing the data structures and producing the reply, but <strong>it is very costly</strong> from the point of view of** doing the socket I/O**. This involves calling the read() and write() syscall, that means <strong>going from user land to kernel land</strong>. The context switch is a <strong>huge speed penalty</strong>.</p>
<p>When pipelining is used, many commands are usually read with a single read() system call, and multiple replies are delivered with a single write() system call.</p>
</blockquote>
<p>Redis 认为，因为高效的数据结构，以及内存操作，Redis Server 执行命令的过程开销实际上不是很大，真正昂贵的操作是频繁的 read/write syscall</p>
<h4 id="transactionpipelinelua-三者区别">transaction、pipeline、lua 三者区别</h4>
<p><strong>transaction 与 pipeline</strong></p>
<ul>
<li><strong>事务是原子操作，pipeline 是非原子操作</strong>。两个不同的事务不会同时运行，而 pipeline 可以同时 <strong>以交错方式</strong> 执行。</li>
<li>Redis 事务中每个命令都需要发送到服务端，而 Pipeline 只需要发送一次，请求次数更少。</li>
</ul>
<p>这里做了一个小实验，验证 pipeline 是不是原子操作：</p>
<p>先来看代码：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;context&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;strconv&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;sync&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="s">&#34;github.com/redis/go-redis/v9&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// InitRedis()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kd">var</span> <span class="nx">wg</span> <span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span>
</span></span><span class="line"><span class="cl">	<span class="nx">wg</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="mi">100</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">rdb</span> <span class="o">:=</span> <span class="nx">redis</span><span class="p">.</span><span class="nf">NewClient</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">redis</span><span class="p">.</span><span class="nx">Options</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Addr</span><span class="p">:</span>     <span class="s">&#34;127.0.0.1:6379&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="nx">Password</span><span class="p">:</span> <span class="s">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="nx">DB</span><span class="p">:</span>       <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="nx">pipe</span> <span class="o">:=</span> <span class="nx">rdb</span><span class="p">.</span><span class="nf">Pipeline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// pipe := rdb.TxPipeline()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="nx">key</span> <span class="o">:=</span> <span class="s">&#34;key&#34;</span> <span class="o">+</span> <span class="nx">strconv</span><span class="p">.</span><span class="nf">Itoa</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">go</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">defer</span> <span class="nx">wg</span><span class="p">.</span><span class="nf">Done</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="mi">1000</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">value</span> <span class="o">:=</span> <span class="s">&#34;value&#34;</span> <span class="o">+</span> <span class="nx">strconv</span><span class="p">.</span><span class="nf">Itoa</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="nx">pipe</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nf">TODO</span><span class="p">(),</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">pipe</span><span class="p">.</span><span class="nf">Exec</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nf">TODO</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nf">Error</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}()</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="nx">wg</span><span class="p">.</span><span class="nf">Wait</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>查看 aof 文件：</p>
<pre tabindex="0"><code>*4
$3
set
$5
key18
$6
value0
$7
keepttl
...
</code></pre><p>可以发现一个 set 命令占了 9 行</p>
<p>假设 pipeline 是原子操作，那么 1000 个命令应该占用 9000 行，那么是不是这样呢？</p>
<p><div class="not-prose">
<figure>
    <img src="http://images.blogs.skylee.top/2024-03-11-16-50-06-150.png"
      alt="image" 
      loading="lazy"
    >
  </figure></div>
</p>
<p><div class="not-prose">
<figure>
    <img src="http://images.blogs.skylee.top/2024-03-11-16-50-23-937.png"
      alt="image" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>可以发现，从起始位置到结束位置之间的行数远大于 9000 行，说明 pipeline <strong>不是原子操作</strong></p>
<p>那 Redis 事务是不是原子操作呢？这里使用 TxPipeLine API 来验证：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">pipe</span> <span class="o">:=</span> <span class="nx">rdb</span><span class="p">.</span><span class="nf">TxPipeline</span><span class="p">()</span>
</span></span></code></pre></div><p>结果如下：</p>
<p><div class="not-prose">
<figure>
    <img src="http://images.blogs.skylee.top/2024-03-11-16-54-12-932.png"
      alt="image" 
      loading="lazy"
    >
  </figure></div>
</p>
<p><div class="not-prose">
<figure>
    <img src="http://images.blogs.skylee.top/2024-03-11-16-54-19-819.png"
      alt="image" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>可以发现，使用事务以后，开始到结束位置的行数确实为 9000 行，说明事务是 <strong>原子操作</strong></p>
<blockquote>
<p>Redis 事务是怎么保证操作是原子的？</p>
<p>当开启一个事务以后，接下来的所有操作都会被放到一个「独立」的队列中</p>
<p>当调用 EXEC 命令时，Redis 会单线程地处理队列中所有的命令，只有当前事务的命令处理完毕以后，才会处理其它事务的命令</p>
<p>而 PipeLine 实际上是一种 <strong>网络优化的手段</strong>，只是批量的发送数据到 Redis Server，没有隔离保障，其它客户端的数据可能与 pipeline 的数据混在一起</p>
</blockquote>
<p><strong>pipeline 与 lua 脚本</strong></p>
<blockquote>
<p>Using Redis scripting, available since Redis 2.6, a number of use cases for pipelining can be addressed more efficiently using scripts that perform a lot of the work needed at the server side. A big advantage of scripting is that it is able to both read and write data with minimal latency, making operations like read, compute, write very fast (<strong>pipelining can&rsquo;t help in this scenario since the client needs the reply of the read command before it can call the write command</strong>).</p>
</blockquote>
<p>当涉及到需要快速执行并且依赖于前一个命令输出的场景时，<strong>Redis 脚本比管道更高效</strong>。例如，如果你需要读取一个键的值，基于这个值做一些计算，然后将结果写回到数据库，使用 Lua 脚本会是一个非常快速的解决方案。整个读取、计算和写入的过程在 Redis 服务器上作为一个单独、原子性的操作执行，客户端只需要发送脚本并接收最终结果。</p>
<p>此外，lua 脚本在服务端执行，可以保证原子操作，这也是 pipeline 做不到的</p>
<blockquote>
<p>补充：如何在 Redis 中使用 lua 脚本？</p>
</blockquote>
<p>在 Redis 中使用 Lua 脚本的步骤相对简单。Redis 内置了对 Lua 脚本语言的支持，这使得你可以在 Redis 服务器上执行原子操作的复杂逻辑。Lua 脚本在 Redis 服务器端运行时，可以保证脚本内的多个命令作为原子操作执行，不会被其他客户端的命令中断。</p>
<p>以下是在 Redis 中使用 Lua 脚本的具体步骤：</p>
<p><strong>编写 Lua 脚本</strong></p>
<p>首先你需要编写 Lua 脚本。一个简单的例子如下，这个脚本会检查一个键是否存在，如果不存在，则设置它的值：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">if</span> <span class="n">redis.call</span><span class="p">(</span><span class="s2">&#34;EXISTS&#34;</span><span class="p">,</span> <span class="n">KEYS</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="kr">then</span>
</span></span><span class="line"><span class="cl">    <span class="n">redis.call</span><span class="p">(</span><span class="s2">&#34;SET&#34;</span><span class="p">,</span> <span class="n">KEYS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ARGV</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="kr">return</span> <span class="s2">&#34;Key was set&#34;</span>
</span></span><span class="line"><span class="cl"><span class="kr">else</span>
</span></span><span class="line"><span class="cl">    <span class="kr">return</span> <span class="s2">&#34;Key already exists&#34;</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span></code></pre></div><p><strong>使用 <code>EVAL</code> 命令执行 Lua 脚本</strong></p>
<p>使用 <code>EVAL</code> 命令将 Lua 脚本发送至 Redis 服务器执行。<code>EVAL</code> 命令的第一个参数是 Lua 脚本的文本，第二个参数指定了脚本中的<code>KEYS</code>数组参数的个数，后续的参数是被脚本使用的 Redis 键和附加的参数。</p>
<p>以前面的 Lua 脚本示例为例，你可以这样调用：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">EVAL &#34;if redis.call(&#39;EXISTS&#39;, KEYS[1]) == 0 then redis.call(&#39;SET&#39;, KEYS[1], ARGV[1]) return &#39;Key was set&#39; else return &#39;Key already exists&#39; end&#34; 1 your-key your-value
</span></span></code></pre></div><p>这里：</p>
<ul>
<li><code>your-key</code> 是 Lua 脚本中 <code>KEYS[1]</code> 的值。</li>
<li><code>your-value</code> 是 Lua 脚本中 <code>ARGV[1]</code> 的值。</li>
<li>数字 <code>1</code> 指的是脚本中只访问一个键。</li>
</ul>
<p><strong>使用 <code>EVALSHA</code> 命令执行预加载的脚本</strong></p>
<p>如果你多次执行同一脚本，可以先使用 <code>SCRIPT LOAD</code> 命令加载脚本到 Redis 服务器并获取返回的 SHA1 校验和。之后可以通过 <code>EVALSHA</code> 命令和这个 SHA1 校验和来执行脚本，而不是每次都传输整个脚本代码：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">EVALSHA sha1-checksum 1 your-key your-value
</span></span></code></pre></div><h4 id="总结">总结</h4>
<ul>
<li>Redis 认为的原子性：一批操作，要么 <strong>执行</strong>，要么 <strong>不执行</strong>，且不会被其他客户端的命令中断</li>
<li>Redis 事务是一个原子操作，不支持回滚，不具备关系型数据库的原子性</li>
<li>pipeline（管道）更像是一种网络 IO 的优化手段，操作不具备原子性</li>
<li>lua 脚本结合了 Redis 事务与 pipeline 的优点，操作具备原子性，并且网络 IO 开销很低</li>
</ul>
<h3 id="bigkey-优化">bigkey 优化</h3>
<p>bigkey 对 Redis 的影响主要在：</p>
<ul>
<li>RDB 持久化、AOF 重写：fork 时间会变长，阻塞 Redis 服务</li>
<li>网络 IO：假设一个 bigkey 的 value 大小为 1M，QPS 为 1k，那么 1s 产生的流量为 1G，直接把千兆网卡打满</li>
<li>删除操作：删除一个 bigkey，在内存还给 OS 后，OS 要对空闲内存管理，即将对应的页放到 free_list 中，如果页太多，这个过程也会比较耗费性能</li>
</ul>
<p>如何优化？</p>
<ul>
<li>尽量不用 bigkey</li>
<li>如果要用，可以将其拆分成若干个子 key</li>
<li>删除时，不直接用 DEL，而是用 UnLink 异步删除，或者分批次删除</li>
</ul>
<blockquote>
<p>DEL 是一个阻塞操作，而 UnLink 只是将 key 从哈希表中移除（unlink），真正释放内存的操作是另外一个线程去 <strong>异步</strong> 地操作的，不会阻塞 Redis 的服务</p>
<p>This command is very similar to DEL: it removes the specified keys. Just like DEL a key is ignored if it does not exist. However the command performs <strong>the actual memory reclaiming in a different thread</strong>, so it is not blocking, while DEL is. This is where the command name comes from: the command <strong>just unlinks the keys from the keyspace</strong>. The actual removal will happen later <strong>asynchronously</strong>.</p>
</blockquote>
<h3 id="hotkey-优化">hotkey 优化</h3>
<p>热点 key 指的是 QPS 相对整个 keyset 来说较高的 key，如果不对热点 key 妥善处理，很有可能因为频繁访问将 Redis 服务干掉</p>
<p>常见的优化方式：</p>
<ul>
<li>读写分离：可以部署多个从节点来分摊主节点的读压力</li>
<li>Redis Cluster：集群模式，保障可用性</li>
<li>多级缓存：应用程序可用实现自适应热点发现，将热点数据缓存到本地，避免访问 Redis</li>
</ul>
<h3 id="内存碎片问题">内存碎片问题</h3>
<p>内存碎片这个问题并不陌生，在 OS 的内存管理就有遇到这个问题</p>
<p>在 Redis 中也有内存碎片的问题，发生的原因主要有两种：</p>
<p><strong>申请内存，并不是按需申请</strong></p>
<blockquote>
<p>To store user keys, Redis allocates at most as much memory as the maxmemory setting enables (however there are small extra allocations possible).</p>
</blockquote>
<p>在申请 size 大小的内存时，通常还要额外申请一小部分内存，这不难理解：如果接下来要使用，就不需要在分配一次内存，直接用就可以（这个思想在 malloc 中也有体现）</p>
<p>当然，如果接下来要申请的内存空间大于预分配的内存，那还是要申请的，这部分内存就成为了内存碎片（当然只要申请的内存小于等于某一块碎片，还是可以用的）</p>
<p><strong>释放内存，并不是立即释放</strong></p>
<blockquote>
<p>Redis <strong>will not always free up (return) memory to the OS when keys are removed</strong>. This is not something special about Redis, but it is how most malloc() implementations work. For example, if you fill an instance with 5GB worth of data, and then remove the equivalent of 2GB of data, the Resident Set Size (also known as the RSS, which is the number of memory pages consumed by the process) will probably still be around 5GB, even if Redis will claim that the user memory is around 3GB. This happens because the underlying allocator can&rsquo;t easily release the memory. For example, often <strong>most of the removed keys were allocated on the same pages as the other keys that still exist</strong>.</p>
</blockquote>
<p>这是因为删除的 key 所在的内存页，可能还有其它 key 的数据，那么这些页就不能归还给 OS</p>
<p>如果这些页无法得到利用，就成为了内存碎片</p>
<p><strong>如何解决</strong></p>
<p>在 Redis 中，可以执行 info memory 查看内存使用情况</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@a6950a95dd7a:/data/appendonlydir# redis-cli -p <span class="m">6379</span>
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt; info memory
</span></span><span class="line"><span class="cl"><span class="c1"># Memory</span>
</span></span><span class="line"><span class="cl">used_memory:1546648
</span></span><span class="line"><span class="cl">used_memory_human:1.47M
</span></span><span class="line"><span class="cl">used_memory_rss:4300800
</span></span><span class="line"><span class="cl">used_memory_rss_human:4.10M
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">mem_fragmentation_ratio:2.82
</span></span><span class="line"><span class="cl">mem_fragmentation_bytes:2774824
</span></span><span class="line"><span class="cl">mem_not_counted_for_evict:640
</span></span><span class="line"><span class="cl">mem_replication_backlog:0
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></div><p>其中 <code>mem_fragmentation_ratio</code> 的值可以反映内存碎片的情况</p>
<pre tabindex="0"><code>mem_fragmentation_ratio = used_memory_rss (操作系统实际分配给 Redis 的物理内存空间大小)/ used_memory(Redis 内存分配器为了存储数据实际申请使用的内存空间大小)
</code></pre><p>因此，mem_fragmentation_ratio 越大，说明碎片率越高</p>
<p>当 mem_fragmentation_ratio &gt; 1.5 就可以考虑做碎片整理了</p>
<blockquote>
<p>mem_fragmentation_ratio 小于 1 是什么情况？</p>
<p>这说明 Redis 实际使用的内存量大于 OS 分配给 Redis 的内存，通常来说是因为内存不足，发生了 swap</p>
</blockquote>
<p><strong>启用碎片整理</strong></p>
<pre tabindex="0"><code class="language-conf" data-lang="conf">#
# 1. This feature is disabled by default, and only works if you compiled Redis
#    to use the copy of Jemalloc we ship with the source code of Redis.
#    This is the default with Linux builds.
#
# 2. You never need to enable this feature if you don&#39;t have fragmentation
#    issues.
#
# 3. Once you experience fragmentation, you can enable this feature when
#    needed with the command &#34;CONFIG SET activedefrag yes&#34;.
#
# The configuration parameters are able to fine tune the behavior of the
# defragmentation process. If you are not sure about what they mean it is
# a good idea to leave the defaults untouched.

# Enabled active defragmentation
# activedefrag no

# Minimum amount of fragmentation waste to start active defrag
# active-defrag-ignore-bytes 100mb

# Minimum percentage of fragmentation to start active defrag
# active-defrag-threshold-lower 10

# Maximum percentage of fragmentation at which we use maximum effort
# active-defrag-threshold-upper 100

# Minimal effort for defrag in CPU percentage, to be used when the lower
# threshold is reached
# active-defrag-cycle-min 1

# Maximal effort for defrag in CPU percentage, to be used when the upper
# threshold is reached
# active-defrag-cycle-max 25
</code></pre><p>Redis 默认关闭了碎片整理，因为这个功能只有在使用 <code>Jemalloc</code> 分配内存才有效，并且碎片整理需要耗费一定性能</p>
<h2 id="redis-生产问题">Redis 生产问题</h2>
<h3 id="缓存雪崩击穿穿透与缓存一致性">缓存雪崩、击穿、穿透与缓存一致性</h3>
<p>可以查看 <a href="http://bluebell.skylee.top/#/post/53786153056210944" target="_blank" rel="noopener">这篇文章</a>
</p>
<h3 id="常见阻塞情况">常见阻塞情况</h3>
<ul>
<li>RDB 持久化，AOF 重写时的 fork</li>
<li>RDB 持久化，AOF 重写时的「写时拷贝」</li>
<li>AOF 的刷盘（fsync）</li>
<li>bigkey 的修改</li>
<li>bigkey 的删除</li>
<li>慢查询</li>
<li>内存淘汰</li>
<li>Redis Server 压力大</li>
<li>主从复制：主进程需要将 RDB 快照发送给从节点，发送过程在其它客户端看来，Redis 服务是阻塞的</li>
<li>故障转移：在故障转移的过程中，写操作可能阻塞</li>
</ul>

    </article>

    



  </div>
</div>

  </main>
  <footer class="flex flex-none justify-center">
    <section class="flex flex-col md:flex-row mx-2 md:mx-0 gap-2 md:gap-0 justify-between w-full max-w-4xl lg:max-w-5xl py-6 text-slate-500 dark:text-slate-300">
  <div class="flex flex-row">
    
  
  
  
  
  
  
  
  
  
  
    <a href="https://github.com/SkyLee424" target="_blank" title="Github" class="flex flex-row mr-2">
      <span class="hidden">Github</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path>
</svg>
 </i>
    </a>
  
  
  
    <a href="https://leetcode.cn/u/sky_lee/" target="_blank" title="LeetCode" class="flex flex-row mr-2">
      <span class="hidden">LeetCode</span>
      <i class="h-6 w-6 flex-none"> <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="96" height="96" viewBox="0 0 96 96" enable-background="new 0 0 24 24" xml:space="preserve">  <image id="image0" width="24" height="24" x="0" y="-1"
    href="data:image/png;base64,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" ></image>
</svg>
 </i>
    </a>
  
  


  </div>
  <div class="grow"></div>
  <div class="flex flex-row">
    <i class="h-6 w-6 flex-none"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
   <path d="M14 9.75a3.016 3.016 0 0 0 -4.163 .173a2.993 2.993 0 0 0 0 4.154a3.016 3.016 0 0 0 4.163 .173"></path>
</svg>
</i> 2024 Sky_Lee
    
  </div>
  
</section>

  </footer>
  <script src="/main.min.c6372b6836971865bd94bfde974748aca8415824a2facab6ccd66a87384bfacb.js"></script>

<div class="hidden top-1 right-1" id="code-copy">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" />
  <path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" />
</svg>

  </i>
</div>
<div class="hidden top-1 right-1" id="code-copy-done">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-check" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l5 5l10 -10" />
</svg>

  </i>
</div><script src="/code-copy.min.4be95a7068ec721962fd0df64ce1c8673df8035fde465874f1e6e67e2aac7f71.js"></script>





</body>
</html>
